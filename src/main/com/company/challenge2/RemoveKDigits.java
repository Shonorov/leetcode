package com.company.challenge2;

import java.util.*;

/**
 * Remove K Digits
 * https://leetcode.com/explore/featured/card/may-leetcoding-challenge/535/week-2-may-8th-may-14th/3328/
 *
 * Given a non-negative integer num represented as a string, remove k digits from the number so that the new number is the smallest possible.
 *
 * Note:
 * The length of num is less than 10002 and will be â‰¥ k.
 * The given num does not contain any leading zero.
 *
 * Example 1:
 * Input: num = "1432219", k = 3
 * Output: "1219"
 * Explanation: Remove the three digits 4, 3, and 2 to form the new number 1219 which is the smallest.
 *
 * Example 2:
 * Input: num = "10200", k = 1
 * Output: "200"
 * Explanation: Remove the leading 1 and the number is 200. Note that the output must not contain leading zeroes.
 *
 * Example 3:
 * Input: num = "10", k = 2
 * Output: "0"
 * Explanation: Remove all the digits from the number and it is left with nothing which is 0.
 *
 * Explanation:
 * Add all characters to the stack.
 * If current less than previous - remove previous (max value in a sequence).
 * Decrement count on remove.
 * Remove remaining count from stack and remove trailing zeroes.
 *
 * Time complexity : O(n * m). m - leading zeroes count.
 * Space complexity : O(n).
 */
public class RemoveKDigits {

    public static void main(String[] args) {
        RemoveKDigits app = new RemoveKDigits();
        System.out.println(app.removeKdigits("1432219", 3)); // 1219
        System.out.println(app.removeKdigits("10200", 1)); // 200
        System.out.println(app.removeKdigits("10", 2)); // 0
        System.out.println(app.removeKdigits("9", 1)); // 0
        System.out.println(app.removeKdigits("112", 1)); // 11
        System.out.println(app.removeKdigits("111", 1)); // 11
        System.out.println(app.removeKdigits("43214321", 4)); // 1321
        System.out.println(app.removeKdigits("1783", 1)); // 173
        System.out.println(app.removeKdigits("1234", 1)); // 123
//        System.out.println(app.removeKdigits("42767854615790820292944831840714943359894187047948450037336809401264092298894490339723170235305129677267060933619172682578764724528024649451075131679109777263591648456729485464839877320061461069243974933498371934575012528555827338953724780861662784034839154178040563249817555067081448332223588411419168442553970020118370358794959779864819714402968003470365044797881527445340976945193818119467023653961507607672480115226579679195083984107550649620824228334531543881248523270728845883011347557806714125988595750797445903460187069102923827814511796767245574859856245433535202213866357865001893279481556044431076323101967578726169437167866864433985495890782177337227185218722003203201794524473658120818757906858018522776715639010350584179192618574032568118118609428514149350137179799798509363342933168141703795277960609902578193965353966732758522319326510476003141627976495471194647651191765940623801848650779996861991716801192868381714592671157213385358454372258678286185038661251898041199455484881497973936886129286780686747702354266676649133047345268803970772136574778724059680910889846701031833468068701979269662983956502485168033946609770137842651146059273082836506077338453677150197865590089199161058651336150874965473699606051616750107442277197178936688141691056518266386172813294511346655182323777419242146803539629808395049965699535272276902817614992917612927025979571436056418178949140225831714010026397581438647144388850448143782384993050908181782121784294922444218824177798052454616802442043385673094510700252387351590505241357656396376170570838637068429512330065547472613577751410152513915714166057883408992271281823592172333654887223386232551975763603851710020471730161184180640812534293795148973065648040320936081719321657015873251252438179935213522036777508405231559635933218588146968578575964379037900738820562221783370763718270548271942160879283346733139062721676158522361533668704462398258010274851756504022170692557968534354343300976925558662656552021225536052236166733671370810493478857779656160557033130699196730596823835866942383406014324343783777539237677792451989779191005800821612057527173069156047746886314264888886920021988864698336973375949221207087151293792642382667520852406157133901720414180577613687865572943934469907502558232579505371542207400025172278481715443291693401941467763248672444891029778464850850998910451866532251760265573729603802891979681199941199058262753251051247038814898450192160069049824567851341865948819288467203875175473770134200197684457826486518709881470102852093201457965720215213058487673191409542861896211110569915555788853974841074076366685605058887536260221712351483096796829688703805892797869297796003334770994443794789460259639436865437812910241961445382357524033812312224783435809748252815436505470248482168172542366777257733653560456219150752921112615226017071525633643673264241122463875175583077761780573333101393148223764295110530230833646717923630745738812086412736671406343368298252156032118474543057099651798412740139013104123480347608236951823601336247508674889789494483794628001425344165783788429049730291326775455015785327577865377064397566794918739831414079787693198248140637113125565595305998282580721676261634498566237966614318941397734268015425568890740425312778238252662876746954156253519077411732018085846119889733839268453412968907858943693089597738545774072868871022839381446938075550039536742864199000908389925554691777850180161524332130073243881970286384249150136987633055208076388268958344328919145620288311537387853748176907053434533948744876865239789707206727054699151876690589023127693784859005126867245144990541144502571475179281742590537105515917376706167473011218582298393879651200544930737095993892411425220115292455512046640587174478149165594377091626060310391405243838577142799370503965244703765138756627518023743947119802986986532252546116477951027231307131628103042104039629499919572735529345439335549727142664736202293026484344441050630567027253471369103560266482945879441209004770164675020115476783653466174012741661723993500655369697109626010269380076073933015864761704176611703072139146747597003865521022642104228419619843927108260238084570397138708740181474347163241522446780620603392403687603888076553679045954833871460870755109132271738691459746851320926797113625441143010401758187073392500078061166186149727409676020612731477477496862648324993156390312514509978182394005049176325656482925314334308846020046440000639094498194888324242274543355772503522914560552598223947118463742841515723677871749503874006924229568354106404788800337347740726960903805684221263837486950787248911647072244868181616958029769190594368044110679179639645980860201597430267777459655372871993352465518117174671133742384885531127239604520105123727230849911680326443684000340446147937873667767227624842441390296900995179520080641610292722850119464836580325090471323736225890294980142988595694394073053215895013346101834933981247547372697246437008031025334926870805534589643288626312674442549515696840972195844322623489776395993997725883102424374473386242230020052319139538725050694563793252575203302986006568926586341522483619750551265949811840701660706687971699572637332236706033725130460780147305930796689592739802762127602300331109088320407488753453562201443009583869340530260133192585867600117793558618622877626140608235883463446585052941889282771610713456594091731994663257672424562807919185250771570978748558016087655314386429181778154999037395977801201222536602668579318195917221851258101758083465833807764504478328133760033685582322103480724065531895932039917203779203156040553746346772387443929520551627122239575483559165994485703508677722865190370481258839816840706093115274279356732858077656941579688491810646089766375954256605013212947107680641700379830628558534532701353225658907237335822869646320919937486195881402477347072922997644748078880017641720321497893274887727279247817230724007001520405446788235407924339589275318658718824019308723325037628135839936194865389246778785484224136240513164802724185350906503263939998152201969404224284851353929162842159002494160461334274924788445418313020719064697643073211899597216839617241323956298475147631936745340993794786362122100021070985418754276295234662670333162104340353095385544657319880579379906274682249802800845859334842970692716308206359497045039047894058089399866389624780981978085896624346900360571598520216940381587071285958497155631482721452214648993874243450874956631856720123296440913509093669827146153180469767433504561046437484524515293979237377991209712765962632838588822180359961992788574139615251950913574644651207439995528858114472995911722528828790960400270676875166161939741700924096377882962772526118510149529098157733017933337496630319171190616687753486928733354625068986857196646261563989044574797981270617089057226390794666311751192327631540192548655459578506043592663616062769069836457346194068474176132510064511610117400341310411426000998578144122817400179584819131405912398612085587124626912794546013764785843274068027858995747888172680971572206968091015445337290861835783980747471461015521311208355915962202714480089884097249709377165451728632422251230084667248727648072440251993269156317610868685295846232492883010588697174635533597605834450249882921427658569868883414799635112078926523707047988262628826843234898036034699263633285219983947947102364186704490860419225940767023498819222899748637736136929299603365634669304329289193002180868079267831256753666692578016598885536576757243005565124272778934460000656133474422706312579704797332965888987321865639934115540341358438065159979966516649509059972742742859883148151328808103859578112480441464277834533174833896376621814776042440697291859846516369392086372254665861285937409320474020680208941413993134675771984152737919309617874095184511004441704637414657377204495521150940370391369816136133983987959653102357045282415379947968251076420098012505820501069271733453309150705588274173445852803861126110689326352001921046066346433959229953549279092972503658190837209557302503876248001129441633640343374507764567392795980560783306587466656895994346821030188171996741604459649768510697714192580042040101750692371398942842500442445462269343139517683266487839338542443169246460653530698650325346136357734184681042975047635944793223022235246268651870018710450581435529607254366048869493833744884331399960456341161524764264081615200455615465925723132075411240169896584999493701334792763601560521725937880035580427191600072833098777060365102978298741740559073275852763938780836609797603716875112885764040607658550533844408290490010802790842002942292935369291644839617793990910895308977723653062881593207714109720695034340437197019621968080117519794848132586742911614980669439330348142456126849768719198483462298008318935405664818315956667907954514033766806239587330742325680711653716183320470951491901907421070418246355033490024779722775524553362711286647617964163847164933401979458666304006708368763218332476561345205255639459643444256743045787508311558394991701816915267581835649555296896252897237006404723594796400109216516930136483261469100739753281302804818082275735965571356243205409672153514152830169411991633125429246600926046750109377245075186063774301024268884824103787866848063266853457600668442319180654169447895010411843408292686118099805402852556814966811008369348597110442872837094072059087232837205291461239853639994518924479438927379348327739109781565914159761167665584025124425923844801188360781762018699315163461229173330894272797116474430040071501881164984840886621509629770804885731934408262630754177569630312231904935609457496213783238786007928894185681679202644961896031520772120429456532334651866707926275039616875628244135012101648429121896413946679889877828086708457516884940565793756567939396973544976573326617620245079002790968407887831523704293463842790307287785628353910524550357149296905848302331279051221613790082068853444332742995671850649946821132877723913186786300652152247618157706125750578092402909964449626211673467131785274416643250628726377006207603592185",8222));
//        System.out.println(app.removeKdigits("17837605025683516120010270503807569928178393773076879170028133735644386709353014199231161016834202821655655947833118094662725822436120397735236953596117990380023771485471207752920307347213671242946302334923503764912432055700309914206103364063868546679428867424925671680526032099860583026255808370544562607516226496473439016990783116948597588838766623253667716587248969590351938547681019783978607010026047562010092976543940682873432990239799550710461153834255732312639561941973686912576394182153793380462425867680992707616498637668115274622735232014853260668113966532173703357431717064856689072299136043201776374633287565311907763102068659145456425775667706742465636096265155225620954708476056834360598143586342230201494961702397022909032525343629831061617524029740549732503118933345637593796835637332517547616659271620123917033661075709601596433920904019940562966413498015263253249142412825157794131174843234468459564274711666179597226827742043712416260860523360910980162117319761001613862299171678360951481566308393036484294993901787894130680931001392000616157647580922439841639930904162442127357667509444631452654167932805427619703245736090536294399929041051371778987081544103794722729388147025080306048634204352473482999895880695647790099394685750968059138436333859732024082730171757660571291417595802305409511232107280448213305231165480398075725857285869998210576485402736425879821085397455562017695363008611558982531486316307465097064168168166658487815536600146283315932845982056278890298387993190330818638373231049780830487273494495335029446430418137643408205920403671258231653232452868714269651394810511710355175377713236438578488103279674195967173766888222940086768571098694600319211909009646094264194127478728305805103963363118964826504060523778271289321697631407503790325751472604195238993275828794013996415561711633048132362919494041488640824641701759738001999542383400962940779371630674046472217805733281151035235202637339708666251450365824897008345046128797810143547987725537060801315455310242100055510909582437698931846483850334421121656504109448458027054491452194125036640794632386363044064534526209022794927345007241843949295466782511131163396823234411657640301905427698838637464844079306709926504479099260924169350712712720553819346627883796715038983527530340835148588622349232098889287963947139438792860255800361338904357812805049008158576663902534879866214043875419939892408257016251187254008934698598094555334280108354961045166987293796437056093657085921743249861532319109419437313463601454403605310855068137894822433238101196348067857972033523106499492535265371355668317593253809469723649187871395394253313828229881100055840458109506522859083007555749510020539324201525847318258764241744156587587916714377617189650554205200096218783642014526134338625548275976534692156322174184289272908952122334334390125082872291718753462353778992786774061266911831163380010223375915147625186721428143918734271528992089669547753557524867193927678623941268765642835531001988613342728339311331436518008901359377528188091555667165266417369977002811666057760084806413986136142955417704207453395457085849860417144543268047259000869805774718905632560977276684469334513978119604880662824867922542277069650187907536528145007583985755581779397657302590781603186091466026695317699892800061246962271357097523840041719784246024157938017994672941138071283119018925067825102464940330960161330506221384470767498008661627388078032860624578288341792501317651352795562576787320849025876548083246080026991031428818934616860288500110530122181734886637210817930716000042033282434677770717688221570127426876756884593282789855645127710287875493065449484125332525782131194923568511998782394785359222944374990359783797996139565156258346668284750667262720017164331953013767319174332903409375014146170940331020158161413416544211410296656831930989378749277259506120863394516398950064571601120864889258970256452671929001756518355749330756989162858306247412160789811176833908729197312700383322749579081734158933041267270230742488610603238898184429599281054988693215966094926483539887796223426073619224164016983857092002203322490838731829975383191772629965699002089808277065674142649866975519862080958190965813467433266995054717084257310341562631107204258353763526033001150670276556008053925726003714053852379201689005206537898107672412863406165354165881794581222402538582394034531943020815806788262514740689040363624138226520225626498812324657465956707980223435355827008328686364511759137999992432999912615887188783463472696784850152944717971072372325001407826815116846814068164938384559303433563786604720728652964069219543873592482001130011436669968153526575222356340367930446960047089186383237087691173292317894861809186558447513467342530162674519674032938817977413616230200646275026145725771248771101275556770493483491542922960629663771245512153294273756271522457001681254659092059182767257308674731917534288876000412360218697010958796382933346522055342511614148908721687298687680706555074691413660641450287858205609079897932889031777686879863949345327919902067397819765566129976750303380498787919297271921563022485220955001386321156137980137964431420532100091395380169215990801030102864362960134313468010877408051734198181101299132707248664138432881249872937753968305146577312351767204170358253387343016295172655145067762158282895537348371904688117450437149681202603501499966279649186174569075973662595689049963796503295154234637886318255497798386504114827192388124335901553175429022938510761582165572277133387192097140927088073158233212599672424927033005320332908224369012492882677292068078799976838113404738896262019497467600014015840334011626700032955692951380739724530263568156856229694296836540211842790419939788353905940465982062254137716945498466221199464580602183146127653116830997363040267934939190525310881553801998634869803521157354862572840952731954076805371435269572781799087347101911930635321924463496679350913435036926716653842331164754250768169343307317778689350987152108621051503084340174600982159019989113081125135930500699750029303290887893589750803412732405083874566006144161734977355260360055058002950219463832766406627457901190761723134590621607883454625136242268922197535166589917201553215741674277432931515989494159382777819092745465469348486101737073281032485649812430434828681099196913301814075666989559974026924390457113955179033305255228898937893472451280502813810149678268880700275090241288033281713565538744548984708044669307636138539658308411024255472658166509096627084043863963566269356917082925983228550149613817244191112851646768205163795913726472355163060739849008478748873768487826246447612436198788626026798471324146594617864729680769128803883786079804675812194890341511688521119787448113127949963821662203643845899442779327148487492549352820964644888437248602540974133245104864009258559180767950503105775370075967755758924119376922693735976724812221179302456898301547602559894802734228541782364427985652310968812856027327383432048808918063964172938440700254071667847703340785843944322842358398810621024842970428964678231838016263710176582859692564550022753163270007492899186139106750344620730775583601603374404611656809556083380699544367815527400373922543500224676274705721502530305043990524412594915859412967077960374102421462025367043748500375724783021816724173527991660601203980715593127762298484821449016372463459938357071741386930866703123614474755510644794949697664270819109571552218800083702074930464244543518434093693787233756741508267220541219832506625757787633598049592230042522262884855819543264184646927099066732042350071149564197732730797613121766044265574636134331540956556007480432896467640904267127326748174824811836600458958156434979294114184118283865697635786772343126668725550962670658596370409520570167064084793707259676243534530952777396939001516895613080144376365203665945733092525665638709263997523400935006451569916203221018118195118889009988016413636294174997794369473615615088456274292111981368731662062475712657309653997977804286141809048069574055575781747164681937644075964228797016561469233065455586059679774742063676295499150812960172504742885572086409822936213457964839564259297121312008094505010430617177272778919073232250748359070544563380172629868353842681267214151593752755066118992780672758673104313983802272083618756278661365527182811526040228986185536362318883731408309039092154304305645013041423615994243737805212911832197589793506833333911463880571935453499466629584072391679149940058608693680756674643583052707123393099161580293933779867187365929811994039237233343422557099716130982798579019502794062413109579149167289883382979869839713817849548283343299912948453900904964446069369601008517232120867037708130205445863620493064655944305168021973101774860919602083858123402739198174526886146067444295776444151792570345120790838463184199980395050456882710537925467406244909145522670812586881979901743891395166912293647291941337440725073532127978368289056650308921614958265259339184282248796248190230190244454117800434040219221772477093568667425954772897015525925329399369704414646762663264843008004555243477131519410179413322104081534024570123200650250991978395787917569552359471594290878528609073068145628999809548286008220597759424658296432291306269900278304769982668646749833919620051711969969525005630565920616181128323653809356542688784636253939263984024338857946939995288757783429529516813603425593738374345551031750187179351207901647517582666572728307485039405285941187820800238594616356765869060405354162213789937424361309256900254240194404175625187259500384452438702613803115895256658215243828658189032004993771341735076887650932388555857497314283598969975768345808741424348410747441870231018072867757297983891684386331405143446009180071463306634941891149758334619330413314655390266243713829108044720274746674032683434818324505265633238071614625733619390693329124957209563676768325862379259859360142740898116587999275280302222309622738078719893335146904356355236313676319868460065296188299103715979790911555198715901140860511528358327056", 1));

    }

    private String removeKdigits2(String num, int k) {
        StringBuilder result = new StringBuilder(num);
        for (int i = 0; i < k; i++) {
            if (result.length() == 1) {
                return "0";
            }
            for (int j = 0; j < result.length() - 1; j++) {
                if (result.charAt(j + 1) < result.charAt(j)) {
                    result.deleteCharAt(j);
                    break;
                }
                if (j == result.length() - 2) {
                    result.deleteCharAt(j + 1);
                }
            }
        }

        int length = result.length() - 1;
        for (int i = 0; i < length; i++) {
            if (result.charAt(0) == '0') {
                result.deleteCharAt(0);
            } else {
                break;
            }
        }
        return result.toString();
    }

    private String removeKdigits(String num, int k) {
        if (num.length() == k) {
            return "0";
        }
        Stack<Character> stack = new Stack<>();
        for (char c : num.toCharArray()) {
            while (!stack.isEmpty() && k > 0 && stack.peek() > c) {
                stack.pop();
                --k;
            }
            stack.push(c);
        }

        while (k-- != 0) {
            stack.pop();
        }

        StringBuffer result = new StringBuffer();
        for (int i = 0; i < stack.size(); ++i) {
            result.append(stack.get(i));
        }

        while (result.length() > 1 && result.charAt(0) == '0') {
            result.deleteCharAt(0);
        }
        return result.toString();
    }
}
